# Data in: documents and indices
Elasticsearch は分散型ドキュメントストアです。Elasticsearchは情報を列挙されたデータ列として保存するのではなく、JSONドキュメントとしてシリアライズされた複雑なデータ構造を保存します。クラスタ内に複数のElasticsearchノードがある場合、保存されたドキュメントはクラスタ内に分散され、どのノードからでもすぐにアクセスすることができます。

ドキュメントが保存されると、ほぼリアルタイムでインデックスが作成され、1秒以内に完全に検索できるようになります。Elasticsearchは、非常に高速な全文検索をサポートする転置インデックスと呼ばれるデータ構造を使用しています。転置インデックスとは、あらゆる文書に現れるユニークな単語をすべてリストアップし、それぞれの単語が出現する文書をすべて特定するものです。

インデックスは最適化されたドキュメントのコレクションと考えることができ、各ドキュメントはフィールドのコレクションであり、データを含むキーと値のペアです。デフォルトでは、Elasticsearchはすべてのフィールドのデータをインデックスし、インデックスされた各フィールドは専用の最適化されたデータ構造を持っています。例えば、テキストフィールドは転置インデックスに、数値フィールドやジオフィールドはBKDツリーに格納されます。フィールドごとのデータ構造を利用して検索結果を組み立て、返すことができることが、Elasticsearchの高速性を支えているのです。

また、Elasticsearchはスキーマレスであるため、ドキュメントに出現する可能性のある様々なフィールドをそれぞれどのように扱うかを明示的に指定しなくても、ドキュメントをインデックス化することが可能です。ダイナミックマッピングが有効な場合、Elasticsearchは自動的に新しいフィールドを検出し、インデックスに追加します。このデフォルトの動作により、インデックスの作成とデータの探索が容易になります。ドキュメントのインデックス作成を開始すれば、Elasticsearchがブーリアン、浮動小数点、整数値、日付、文字列を検出し、適切なElasticsearchデータ型にマッピングしてくれます。

しかし、最終的にはElasticsearchよりもお客様の方がデータについて、またその利用方法について詳しいのです。ダイナミックマッピングを制御するルールを定義したり、マッピングを明示的に定義することで、フィールドの保存やインデックスの付け方を完全に制御することができます。

独自のマッピングを定義することで、以下のことが可能になります。

- 全文文字列フィールドと正確な値の文字列フィールドを区別する。
- 言語固有のテキスト解析の実行
- 部分マッチングのためのフィールドの最適化
- カスタム日付フォーマットの使用
- geo_point や geo_shape など、自動検出できないデータ型の使用

目的に応じて同じフィールドをさまざまな方法でインデックス化すると便利なことがよくあります。たとえば、ある文字列フィールドを、全文検索のためのテキストフィールドと、データのソートや集計のためのキーワードフィールドの両方としてインデックス化したい場合があります。また、ユーザー入力が含まれる文字列フィールドの内容を処理するために、複数の言語解析ツールを使用することもできます。

インデックス作成時にフルテキストフィールドに適用された解析チェーンは、検索時にも使用されます。フルテキストフィールドにクエリを発行する際、クエリテキストは、インデックスで用語を検索する前に同じ分析を受けます。
