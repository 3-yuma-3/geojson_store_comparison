# Import geospatial data
Elastic Stackに地理空間データをインポートするには、そのデータがgeo_pointまたはgeo_shapeとしてインデックスされている必要があります。地理空間データは様々なフォーマットで提供されています。地理空間データのフォーマットに基づいてインポートツールを選択してください。

## Security privileges
Elastic Stackのセキュリティ機能は、どのユーザーがファイルをアップロードできるかを制御するロールと特権を提供します。ロール、特権、スペースは、KibanaのStack Managementで管理することができます。詳細については、「セキュリティ特権、Kibana特権、およびKibanaロール管理」を参照してください。

Kibana with Maps で GeoJSON ファイル、シェイプファイル、および描画フィーチャをアップロードするには、以下のものが必要です。

- マップのKibana全権限
- インデックスパターン管理のall Kibana権限
- デスティネーション インデックスに対する create および create_index インデックス権限
- Mapsでインデックスを使用するには、宛先インデックスのreadおよびview_index_metadataインデックス権限も必要です

Kibanaのホームページで区切りファイル（CSV、TSV、JSONファイルなど）をアップロードするには、以下の権限も必要です。

- Discover の all Kibana 権限
- manage_pipeline または manage_ingest_pipelines クラスタ権限
- 宛先インデックスに対する manage index 特権

## Upload delimited files with latitude and longitude columns
Kibana のホームページでは、ファイルをアップロードして、緯度・経度の列を geo_point フィールドにまとめた Elasticsearch インデックスにインポートすることができます。

1. Kibana のホーム ページに移動し、「Upload a file」をクリックします。
2. サポートされているファイル形式の一つでファイルを選択します。
3. インポート] をクリックします。
4. 詳細] タブを選択します。
5. インデックス名を設定します。
6. 結合されたジオポイントフィールドが自動的に作成されない場合は、[結合フィールドの追加] をクリックし、[ジオポイントフィールドの追加] をクリックします。
7. フォームに必要事項を記入し、Add をクリックします。
8. インポート］をクリックします。

## Upload a GeoJSON file
ElasticsearchのGeoJSONフィーチャーをインデックス化し、各フィーチャーのドキュメントを作成するファイルをアップロードします。

GeoJSONフィーチャーの座標はEPSG:4326座標参照系である必要があります。

1. 新しいマップを作成します。
2. Add layerをクリックします。
3. Upload file を選択します。
4. ファイル選択ツールを使用して、拡張子が .json または .geojson の GeoJSON ファイルを選択します。
5. ファイルのインポートをクリックします。

## Upload a shapefile
アップロードファイルは、Elasticsearchのシェイプファイルのフィーチャーをインデックス化し、各フィーチャーのドキュメントを作成します。

1. 新しいマップを作成します。
2. レイヤーの追加をクリックします。
3. Upload fileを選択します。
4. ファイル選択ツールを使って、シェイプファイルフォルダから .shp ファイルを選択します。
5. .dbf ファイル選択ツールを使って、シェイプファイルフォルダから.dbf ファイルを選択します。
6. .prj file chooser を使用して、シェープファイルフォルダから .prj ファイルを選択します。
7. .shx file chooser を使って、シェープファイルフォルダから .shx ファイルを選択します。
8. ファイルのインポートをクリックします。

## Draw features in a map
地図上に線、多角形、円、バウンディングボックス、点を描画し、Elasticsearchにフィーチャーをアップロードします。

描画用のインデックスを新規に作成する。

1. マップを作成します。
2. レイヤーの追加をクリックします。
3. インデックスの作成」を選択します。
4. インデックス名を設定します。
5. インデックスの作成] をクリックします。

既存のインデックスを開いて描画する場合

1. マップを作成します。
2. レイヤーの追加] をクリックします。
3. ドキュメント] を選択します。
4. インデックスを参照するデータビューを選択します。データ ビューは、1 つまたは複数のインデックスを指すことができます。フィーチャー編集の場合、データビューは単一のインデックスを指す必要があります。
5. レイヤーの追加] をクリックします。
6. 保存して閉じる］をクリックします。
7. 凡例でレイヤー名をクリックし、[フィーチャーの編集] を選択します。

フィーチャー編集を開くと、マップの左側にフィーチャー編集ツールボックスが表示されます。

フィーチャーを描くには

1. 線、多角形、円、バウンディングボックス、または点のアイコンをクリックします。
2. マウスカーソルを地図上に移動させ、画面の指示に従ってフィーチャーを描画します。
  - フィーチャーが完成すると、そのフィーチャーは新しいドキュメントとしてインデックスに追加されます。
3. この操作を繰り返して、さらにフィーチャーを描きます。
4. フィーチャーの追加が終了したら、凡例に移動し、レイヤー名の下にある Exit をクリックします。

## Upload data with IP addresses
GeoIPプロセッサーは、IPアドレスの地理的な位置に関する情報を追加するプロセッサーです。詳細については、「GeoIP プロセッサ」を参照してください。プライベート IP アドレスについては、「内部プライベート IP アドレスからの GeoIP でデータをリッチ化する」を参照してください。

## Upload data with GDAL
GDAL (Geospatial Data Abstraction Library) は、75種類の地理空間ファイルフォーマット間で地理空間データを変換し、その地理空間データをElasticsearchにインデックスすることができるコマンドラインツールを含んでいます。詳しくはGDALを使ったElasticsearchへの地理空間データの取り込みをご覧ください。
